# Rx-SQLite

A wrapper library that adds [RxJS 5](https://github.com/ReactiveX/RxJS) API to [sqlite3](https://github.com/mapbox/node-sqlite3/)

# Installation

    npm install rx-sqlite --save

or

    yarn add rx-sqlite

# Usage

```js
import RxDatabase from "rx-sqlite";
import "rxjs";

let sql = `create table users (name text);
    insert into users values ("john");
    insert into users values ("bob");`;

let db = new RxDatabase(":memory:");

db.exec(sql)
  .switchMap(() => db.each("select rowid, name from users"))
  .subscribe(u => console.log(u));
```

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## RxDatabase

[src/database.js:12-131](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L12-L131 "Source code on GitHub")

Database Wrapper Object that adds [RxJS 5](https://github.com/ReactiveX/RxJS) API to [sqlite3](https://github.com/mapbox/node-sqlite3/)

### constructor

[src/database.js:20-22](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L20-L22 "Source code on GitHub")

make new RxDatabase object and open Database.

**Parameters**

-   `filename` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** `":memory:"` or filepath
-   `mode` **[Mode](#mode)** (Optional) one or combination value of [Mode](#mode)

### prepare

[src/database.js:29-40](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L29-L40 "Source code on GitHub")

prepare SQL and bind parameters.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** SQL query string.
-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **[RxStatement](#rxstatement)** 

### run

[src/database.js:47-49](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L47-L49 "Source code on GitHub")

Binds parameters and executes the query.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** SQL query string.
-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### get

[src/database.js:56-58](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L56-L58 "Source code on GitHub")

Binds parameters and executes the query and retrieves a row.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** SQL query string.
-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### all

[src/database.js:65-67](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L65-L67 "Source code on GitHub")

Binds parameters and executes the query and retrieves all rows at one time.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** SQL query string.
-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;T>>** 

### each

[src/database.js:74-91](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L74-L91 "Source code on GitHub")

Binds parameters and executes the query and retrieves all rows.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** SQL query string.
-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### exec

[src/database.js:96-98](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L96-L98 "Source code on GitHub")

executes the multiple query.

**Parameters**

-   `sql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **Observable&lt;void>** 

### events

[src/database.js:103-111](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L103-L111 "Source code on GitHub")

make new specified event stream.

**Parameters**

-   `eventNames` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[EventName](#eventname)>** 

Returns **Observable&lt;[Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)>** 

### busyTimeout

[src/database.js:117-121](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L117-L121 "Source code on GitHub")

[Set A Busy Timeout](https://www.sqlite.org/c3ref/busy_timeout.html)

**Parameters**

-   `timeout` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** milliseconds of sleeping time

### close

[src/database.js:128-130](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/database.js#L128-L130 "Source code on GitHub")

close the Database.

you should call this method when you work done

## verbose

[src/index.js:9-11](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L9-L11 "Source code on GitHub")

see [node-sqlite3/Debugging](https://github.com/mapbox/node-sqlite3/wiki/Debugging)

## OPEN_READONLY

[src/index.js:16-16](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L16-L16 "Source code on GitHub")

The database is opened in read-only mode.

## OPEN_READWRITE

[src/index.js:21-21](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L21-L21 "Source code on GitHub")

The database is opened for reading and writing if possible.

## OPEN_CREATE

[src/index.js:26-26](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L26-L26 "Source code on GitHub")

The database is opened for reading and writing, and is created if it does not already exist.

## Mode

[src/index.js:31-31](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L31-L31 "Source code on GitHub")

supported database opening flags

Type: ([OPEN_READONLY](#open_readonly) \| [OPEN_READWRITE](#open_readwrite) \| [OPEN_CREATE](#open_create))

## EventName

[src/index.js:36-36](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/index.js#L36-L36 "Source code on GitHub")

supported event names

Type: (`"error"` \| `"open"` \| `"close"` \| `"profile"` \| `"trace"`)

## RxStatement

[src/statement.js:10-104](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L10-L104 "Source code on GitHub")

Statement Wrapper Object that adds [RxJS 5](https://github.com/ReactiveX/RxJS) API to [sqlite3](https://github.com/mapbox/node-sqlite3/)

### errors

[src/statement.js:20-29](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L20-L29 "Source code on GitHub")

make new error event stream.

Returns **Observable&lt;{error: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)}>** 

### run

[src/statement.js:35-37](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L35-L37 "Source code on GitHub")

Binds parameters and executes the statement.

**Parameters**

-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### get

[src/statement.js:43-45](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L43-L45 "Source code on GitHub")

Binds parameters and executes the statement and retrieves a row.

**Parameters**

-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### all

[src/statement.js:51-53](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L51-L53 "Source code on GitHub")

Binds parameters and executes the statement and retrieves all rows at one time.

**Parameters**

-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;T>>** 

### each

[src/statement.js:59-78](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L59-L78 "Source code on GitHub")

Binds parameters and executes the statement and retrieves all rows.

**Parameters**

-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;T>** 

### bind

[src/statement.js:84-88](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L84-L88 "Source code on GitHub")

Binds parameters to the prepared statement

**Parameters**

-   `params` **...[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>** see [passing bind parameters](https://github.com/mapbox/node-sqlite3/wiki/API#databaserunsql-param--callback)

Returns **Observable&lt;[RxStatement](#rxstatement)>** 

### reset

[src/statement.js:93-97](https://github.com/taichi/rx-sqlite/blob/818bf5b6d5aba3543ab842629b0ccb85eb97f6d8/src/statement.js#L93-L97 "Source code on GitHub")

Returns **Observable&lt;[RxStatement](#rxstatement)>** 

# Development

## Setup

    git clone https://github.com/taichi/rx-sqlite
    yarn install
    yarn setup

## Build

    yarn build

# License

    Copyright 2017 taichi

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
